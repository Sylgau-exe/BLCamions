<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BL Camions â€” Outil de dÃ©cision PMO</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in { animation: fadeIn 0.3s ease-out; }
    .chat-container::-webkit-scrollbar { width: 6px; }
    .chat-container::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-100 to-slate-200 min-h-screen p-4 md:p-8">
  <div class="max-w-2xl mx-auto">
    <!-- Header -->
    <div class="bg-gradient-to-r from-teal-700 to-teal-600 text-white p-6 rounded-t-2xl shadow-lg">
      <div class="flex items-center gap-3">
        <span class="text-4xl">ðŸ¤–</span>
        <div>
          <h1 class="text-2xl font-bold">Outil de dÃ©cision PMO</h1>
          <p class="text-teal-100">BL Camions â€” Projet ou OpÃ©rationnel?</p>
        </div>
      </div>
    </div>

    <!-- Chat Container -->
    <div id="chatContainer" class="chat-container bg-white border-x border-gray-200 h-96 overflow-y-auto p-4 space-y-4">
      <div id="welcomeMessage" class="text-center text-gray-400 py-16">
        <div class="text-6xl mb-4">ðŸ’¬</div>
        <p class="text-lg">DÃ©crivez votre initiative pour commencer</p>
        <p class="text-sm mt-2">L'outil vous guidera Ã  travers les critÃ¨res de dÃ©cision</p>
      </div>
    </div>

    <!-- Progress Bar -->
    <div id="progressBar" class="bg-gray-50 px-4 py-3 border-x border-gray-200 hidden">
      <div class="flex items-center justify-between text-sm">
        <div class="flex items-center gap-3">
          <span id="tier1Badge" class="px-3 py-1 rounded-full text-xs font-bold bg-red-100 text-red-700">Niveau 1: 0/3</span>
          <span id="tier2Badge" class="px-3 py-1 rounded-full text-xs font-bold bg-gray-100 text-gray-400 hidden">Niveau 2: 0/3</span>
        </div>
      </div>
      <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
        <div id="progressFill" class="h-2 rounded-full transition-all duration-500 bg-gradient-to-r from-red-400 to-red-500" style="width: 0%"></div>
      </div>
    </div>

    <!-- Input Area -->
    <div class="bg-white border border-gray-200 rounded-b-2xl p-5 shadow-lg">
      <!-- Initial Input -->
      <div id="initialInput">
        <label class="block text-sm font-medium text-gray-700 mb-2">
          Quelle initiative voulez-vous Ã©valuer?
        </label>
        <div class="flex gap-3">
          <input
            type="text"
            id="initiativeInput"
            placeholder="Ex: Implanter un nouveau CRM Salesforce..."
            class="flex-1 border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"
            onkeypress="if(event.key === 'Enter') startAssessment()"
          >
          <button
            onclick="startAssessment()"
            class="bg-teal-600 text-white px-6 py-3 rounded-xl hover:bg-teal-700 transition font-medium shadow-md hover:shadow-lg"
          >
            Ã‰valuer â†’
          </button>
        </div>
      </div>

      <!-- Question Buttons -->
      <div id="questionArea" class="hidden">
        <p id="questionHint" class="text-sm text-gray-500 mb-3 italic"></p>
        <div id="questionExamples" class="text-xs mb-4 grid grid-cols-2 gap-2 hidden">
          <div class="bg-green-50 border border-green-200 rounded-lg p-2">
            <span class="font-bold text-green-700">Exemple OUI:</span>
            <p id="exampleOui" class="text-green-600"></p>
          </div>
          <div class="bg-blue-50 border border-blue-200 rounded-lg p-2">
            <span class="font-bold text-blue-700">Exemple NON:</span>
            <p id="exampleNon" class="text-blue-600"></p>
          </div>
        </div>
        <div class="flex gap-4">
          <button
            onclick="handleAnswer('oui')"
            class="flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white py-4 rounded-xl hover:from-green-600 hover:to-green-700 transition font-bold text-lg shadow-md hover:shadow-lg"
          >
            âœ“ Oui
          </button>
          <button
            onclick="handleAnswer('non')"
            class="flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 rounded-xl hover:from-blue-600 hover:to-blue-700 transition font-bold text-lg shadow-md hover:shadow-lg"
          >
            âœ— Non
          </button>
        </div>
      </div>

      <!-- Result Area -->
      <div id="resultArea" class="hidden text-center">
        <div id="resultBadge" class="inline-block px-8 py-4 rounded-xl text-white font-bold text-xl mb-4 shadow-lg"></div>
        <p id="resultTrigger" class="text-sm text-gray-600 mb-4"></p>
        <div id="nextStep" class="bg-gray-50 rounded-lg p-3 mb-4 text-sm text-left"></div>
        <div class="flex gap-3 justify-center flex-wrap">
          <button onclick="resetTool()" class="bg-gray-200 text-gray-700 px-5 py-2.5 rounded-lg hover:bg-gray-300 transition font-medium">
            ðŸ”„ Nouvelle Ã©valuation
          </button>
          <button onclick="copyReport()" class="bg-teal-600 text-white px-5 py-2.5 rounded-lg hover:bg-teal-700 transition font-medium">
            ðŸ“‹ Copier rapport
          </button>
          <button onclick="downloadReport()" class="bg-amber-500 text-white px-5 py-2.5 rounded-lg hover:bg-amber-600 transition font-medium">
            ðŸ’¾ TÃ©lÃ©charger
          </button>
        </div>
      </div>
    </div>

    <!-- Legend -->
    <div class="mt-6 bg-white border border-gray-200 rounded-xl p-5 shadow-md">
      <h3 class="font-bold text-gray-700 mb-3 flex items-center gap-2">
        <span>ðŸ“Š</span> Logique de dÃ©cision
      </h3>
      <div class="grid md:grid-cols-2 gap-4">
        <div class="bg-gradient-to-br from-red-50 to-red-100 border border-red-200 rounded-xl p-4">
          <div class="flex items-center gap-2 mb-2">
            <span class="bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">NIVEAU 1</span>
            <span class="text-red-700 font-bold">1 OUI = PROJET</span>
          </div>
          <ul class="text-sm text-red-600 space-y-1">
            <li>â€¢ Multi-fonctionnel (plusieurs dÃ©partements)</li>
            <li>â€¢ Nouvelle capacitÃ© (crÃ©er du nouveau)</li>
            <li>â€¢ Ressources externes (fournisseurs)</li>
          </ul>
        </div>
        <div class="bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-xl p-4">
          <div class="flex items-center gap-2 mb-2">
            <span class="bg-orange-500 text-white text-xs font-bold px-2 py-1 rounded">NIVEAU 2</span>
            <span class="text-orange-700 font-bold">2+ OUI = PROJET</span>
          </div>
          <ul class="text-sm text-orange-600 space-y-1">
            <li>â€¢ Budget dÃ©diÃ© requis</li>
            <li>â€¢ DurÃ©e &gt; 90 jours</li>
            <li>â€¢ Risque stratÃ©gique Ã©levÃ©</li>
          </ul>
        </div>
      </div>
      <div class="mt-4 text-center text-sm text-gray-500">
        Si aucun critÃ¨re n'est dÃ©clenchÃ© â†’ <span class="text-blue-600 font-medium">DMS (OpÃ©rationnel)</span>
      </div>
    </div>

    <!-- Footer -->
    <div class="mt-4 text-center text-xs text-gray-400">
      BL Camions â€” Outil de dÃ©cision PMO v1.0 | Framework Ã  deux niveaux
    </div>
  </div>

  <script>
    // State
    let step = 0;
    let initiative = '';
    let answers = {};
    let result = null;

    const tier1Questions = [
      {
        id: 'multifonctionnel',
        label: 'Multi-fonctionnel',
        question: "Cette initiative requiert-elle des ressources dÃ©diÃ©es de plusieurs dÃ©partements qui ne travaillent pas normalement ensemble?",
        hint: "ðŸ’¡ Ex: IT + Ventes + Marketing doivent collaborer activement",
        examples: { oui: "Implantation CRM (IT + Ventes + Marketing)", non: "AmÃ©liorer les scripts d'appels (Ventes seul)" }
      },
      {
        id: 'nouvelle_capacite',
        label: 'Nouvelle capacitÃ©',
        question: "Cette initiative crÃ©e-t-elle une capacitÃ© qui n'existe pas aujourd'hui dans l'organisation?",
        hint: "ðŸ’¡ CrÃ©er quelque chose de nouveau vs amÃ©liorer l'existant",
        examples: { oui: "Nouveau configurateur en ligne pour clients", non: "Optimiser le processus de facturation existant" }
      },
      {
        id: 'externe',
        label: 'Ressources externes',
        question: "Cette initiative requiert-elle des ressources externes (fournisseurs, consultants, partenaires)?",
        hint: "ðŸ’¡ Implique gestion contractuelle et livrables externes",
        examples: { oui: "Entente de prÃ©-positionnement avec Mercedes-Benz", non: "Formation interne donnÃ©e par un collÃ¨gue" }
      }
    ];

    const tier2Questions = [
      {
        id: 'budget',
        label: 'Budget dÃ©diÃ©',
        question: "Cette initiative nÃ©cessite-t-elle un budget dÃ©diÃ© hors des opÃ©rations courantes?",
        hint: "ðŸ’¡ Budget spÃ©cifique Ã  faire approuver vs budget opÃ©rationnel dÃ©jÃ  allouÃ©"
      },
      {
        id: 'duree',
        label: 'DurÃ©e > 90 jours',
        question: "Cette initiative dÃ©passe-t-elle 90 jours (un cycle de Roche)?",
        hint: "ðŸ’¡ Traverse plusieurs trimestres, requiert un suivi Ã  plus long terme"
      },
      {
        id: 'risque',
        label: 'Risque stratÃ©gique',
        question: "L'Ã©chec de cette initiative impacterait-il significativement les objectifs stratÃ©giques (1HAG)?",
        hint: "ðŸ’¡ Risque Ã©levÃ© qui justifie une supervision formelle"
      }
    ];

    function addMessage(speaker, text, isResult = false) {
      const container = document.getElementById('chatContainer');
      const welcome = document.getElementById('welcomeMessage');
      if (welcome) welcome.remove();

      const msgDiv = document.createElement('div');
      msgDiv.className = `flex fade-in ${speaker === 'user' ? 'justify-end' : 'justify-start'}`;
      
      let bubbleClass = 'max-w-sm lg:max-w-md px-4 py-3 rounded-2xl shadow-sm ';
      if (speaker === 'user') {
        bubbleClass += 'bg-teal-600 text-white rounded-br-sm';
      } else if (isResult) {
        bubbleClass += 'bg-gradient-to-r from-amber-50 to-amber-100 border-2 border-amber-300 text-gray-800 rounded-bl-sm';
      } else {
        bubbleClass += 'bg-gray-100 text-gray-800 rounded-bl-sm';
      }
      
      msgDiv.innerHTML = `<div class="${bubbleClass}"><p class="whitespace-pre-line text-sm leading-relaxed">${text}</p></div>`;
      container.appendChild(msgDiv);
      container.scrollTop = container.scrollHeight;
    }

    function updateProgress() {
      const progressBar = document.getElementById('progressBar');
      const progressFill = document.getElementById('progressFill');
      const tier1Badge = document.getElementById('tier1Badge');
      const tier2Badge = document.getElementById('tier2Badge');

      if (step > 0 && !result) {
        progressBar.classList.remove('hidden');
        progressFill.style.width = `${(step / 6) * 100}%`;

        if (step <= 3) {
          tier1Badge.textContent = `Niveau 1: ${step}/3`;
          tier1Badge.className = 'px-3 py-1 rounded-full text-xs font-bold bg-red-100 text-red-700';
          tier2Badge.classList.add('hidden');
          progressFill.className = 'h-2 rounded-full transition-all duration-500 bg-gradient-to-r from-red-400 to-red-500';
        } else {
          tier1Badge.textContent = 'âœ“ Niveau 1';
          tier1Badge.className = 'px-3 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700';
          tier2Badge.textContent = `Niveau 2: ${step - 3}/3`;
          tier2Badge.className = 'px-3 py-1 rounded-full text-xs font-bold bg-orange-100 text-orange-700';
          tier2Badge.classList.remove('hidden');
          progressFill.className = 'h-2 rounded-full transition-all duration-500 bg-gradient-to-r from-orange-400 to-orange-500';
        }
      } else {
        progressBar.classList.add('hidden');
      }
    }

    function showQuestionUI(question) {
      document.getElementById('initialInput').classList.add('hidden');
      document.getElementById('questionArea').classList.remove('hidden');
      document.getElementById('resultArea').classList.add('hidden');

      document.getElementById('questionHint').textContent = question.hint || '';
      
      const examplesDiv = document.getElementById('questionExamples');
      if (question.examples) {
        document.getElementById('exampleOui').textContent = question.examples.oui;
        document.getElementById('exampleNon').textContent = question.examples.non;
        examplesDiv.classList.remove('hidden');
      } else {
        examplesDiv.classList.add('hidden');
      }
    }

    function showResult(verdict, trigger) {
      document.getElementById('initialInput').classList.add('hidden');
      document.getElementById('questionArea').classList.add('hidden');
      document.getElementById('resultArea').classList.remove('hidden');
      document.getElementById('progressBar').classList.add('hidden');

      const badge = document.getElementById('resultBadge');
      const nextStep = document.getElementById('nextStep');
      
      if (verdict === 'PMO') {
        badge.className = 'inline-block px-8 py-4 rounded-xl text-white font-bold text-xl mb-4 shadow-lg bg-gradient-to-r from-green-500 to-green-600';
        badge.textContent = 'ðŸ“ PROJET â†’ PMO';
        nextStep.innerHTML = '<p class="font-medium text-gray-700 mb-1">Prochaine Ã©tape:</p><p class="text-gray-600">â†’ ComplÃ©ter une <strong>Charte de projet</strong> et soumettre au PMO pour priorisation</p>';
      } else {
        badge.className = 'inline-block px-8 py-4 rounded-xl text-white font-bold text-xl mb-4 shadow-lg bg-gradient-to-r from-blue-500 to-blue-600';
        badge.textContent = 'ðŸ”„ OPÃ‰RATIONNEL â†’ DMS';
        nextStep.innerHTML = '<p class="font-medium text-gray-700 mb-1">Prochaine Ã©tape:</p><p class="text-gray-600">â†’ Utiliser le <strong>gabarit DMAIC</strong> existant et suivre via le rythme DMS habituel</p>';
      }
      
      document.getElementById('resultTrigger').innerHTML = `<span class="font-medium">DÃ©clencheur:</span> ${trigger}`;
    }

    function startAssessment() {
      const input = document.getElementById('initiativeInput');
      initiative = input.value.trim();
      if (!initiative) {
        input.classList.add('border-red-500', 'ring-2', 'ring-red-200');
        setTimeout(() => input.classList.remove('border-red-500', 'ring-2', 'ring-red-200'), 1500);
        return;
      }

      addMessage('user', `Je veux Ã©valuer: "${initiative}"`);
      
      setTimeout(() => {
        addMessage('bot', `Parfait! Je vais vous poser quelques questions pour dÃ©terminer si "${initiative}" doit aller au <strong>PMO</strong> (projet) ou rester dans le <strong>DMS</strong> (opÃ©rationnel).`);
      }, 300);
      
      setTimeout(() => {
        addMessage('bot', `ðŸ“‹ <strong>NIVEAU 1 â€” CritÃ¨res primaires</strong>\nUn seul OUI = PROJET`);
      }, 900);
      
      setTimeout(() => {
        step = 1;
        updateProgress();
        addMessage('bot', `<strong>Question 1/3:</strong>\n${tier1Questions[0].question}`);
        showQuestionUI(tier1Questions[0]);
      }, 1500);
    }

    function handleAnswer(answer) {
      const currentQuestions = step <= 3 ? tier1Questions : tier2Questions;
      const questionIndex = step <= 3 ? step - 1 : step - 4;
      const currentQuestion = currentQuestions[questionIndex];
      
      answers[currentQuestion.id] = answer;
      addMessage('user', answer === 'oui' ? 'âœ“ Oui' : 'âœ— Non');

      // Tier 1 logic
      if (step <= 3) {
        if (answer === 'oui') {
          result = { verdict: 'PMO', trigger: `Niveau 1: ${currentQuestion.label}`, answers: {...answers} };
          
          setTimeout(() => addMessage('bot', `âœ… <strong>CritÃ¨re "${currentQuestion.label}" dÃ©clenchÃ©!</strong>`), 300);
          setTimeout(() => {
            addMessage('bot', `ðŸŽ¯ <strong>VERDICT: PROJET â†’ PMO</strong>\n\nCette initiative nÃ©cessite une <strong>Charte de projet</strong> et entre dans le processus PMO.`, true);
            showResult('PMO', result.trigger);
          }, 900);
          return;
        }
        
        if (step < 3) {
          step++;
          updateProgress();
          setTimeout(() => {
            addMessage('bot', `<strong>Question ${step}/3:</strong>\n${tier1Questions[step - 1].question}`);
            showQuestionUI(tier1Questions[step - 1]);
          }, 400);
        } else {
          setTimeout(() => addMessage('bot', `Aucun critÃ¨re de Niveau 1 dÃ©clenchÃ©. âœ“\n\nðŸ“‹ <strong>NIVEAU 2 â€” CritÃ¨res secondaires</strong>\n2 OUI ou plus = PROJET`), 400);
          step = 4;
          setTimeout(() => {
            updateProgress();
            addMessage('bot', `<strong>Question 1/3:</strong>\n${tier2Questions[0].question}`);
            showQuestionUI(tier2Questions[0]);
          }, 1200);
        }
      } else {
        // Tier 2 logic
        if (step < 6) {
          step++;
          updateProgress();
          setTimeout(() => {
            addMessage('bot', `<strong>Question ${step - 3}/3:</strong>\n${tier2Questions[step - 4].question}`);
            showQuestionUI(tier2Questions[step - 4]);
          }, 400);
        } else {
          const tier2Yeses = ['budget', 'duree', 'risque'].filter(k => answers[k] === 'oui');
          const tier2Labels = tier2Questions.filter(q => answers[q.id] === 'oui').map(q => q.label);
          
          if (tier2Yeses.length >= 2) {
            result = { verdict: 'PMO', trigger: `Niveau 2: ${tier2Yeses.length} critÃ¨res (${tier2Labels.join(', ')})`, answers: {...answers} };
            setTimeout(() => addMessage('bot', `âœ… <strong>${tier2Yeses.length} critÃ¨res de Niveau 2 dÃ©clenchÃ©s:</strong> ${tier2Labels.join(', ')}`), 300);
            setTimeout(() => {
              addMessage('bot', `ðŸŽ¯ <strong>VERDICT: PROJET â†’ PMO</strong>\n\nCette initiative nÃ©cessite une <strong>Charte de projet</strong> et entre dans le processus PMO.`, true);
              showResult('PMO', result.trigger);
            }, 900);
          } else {
            result = { verdict: 'DMS', trigger: `Aucun critÃ¨re Niveau 1, ${tier2Yeses.length} critÃ¨re(s) Niveau 2`, answers: {...answers} };
            setTimeout(() => addMessage('bot', `${tier2Yeses.length} critÃ¨re(s) de Niveau 2 seulement (il en faut 2+).`), 300);
            setTimeout(() => {
              addMessage('bot', `ðŸŽ¯ <strong>VERDICT: OPÃ‰RATIONNEL â†’ DMS</strong>\n\nCette initiative reste dans le rythme DMS habituel. Utilisez le <strong>gabarit DMAIC</strong>.`, true);
              showResult('DMS', result.trigger);
            }, 900);
          }
        }
      }
    }

    function generateReport() {
      const date = new Date().toLocaleDateString('fr-CA');
      const time = new Date().toLocaleTimeString('fr-CA', { hour: '2-digit', minute: '2-digit' });
      
      let report = `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Ã‰VALUATION PMO â€” BL CAMIONS
Date: ${date} Ã  ${time}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INITIATIVE:
${initiative}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
VERDICT: ${result.verdict === 'PMO' ? 'ðŸ“ PROJET â†’ PMO' : 'ðŸ”„ OPÃ‰RATIONNEL â†’ DMS'}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DÃ©clencheur: ${result.trigger}

RÃ‰PONSES AUX CRITÃˆRES:

Niveau 1 (1 OUI = Projet):
`;
      tier1Questions.forEach(q => {
        const ans = result.answers[q.id] || 'non';
        report += `  ${ans === 'oui' ? 'âœ“' : 'âœ—'} ${q.label}: ${ans.toUpperCase()}\n`;
      });
      
      report += `\nNiveau 2 (2+ OUI = Projet):\n`;
      tier2Questions.forEach(q => {
        const ans = result.answers[q.id] || '-';
        report += `  ${ans === 'oui' ? 'âœ“' : ans === 'non' ? 'âœ—' : '-'} ${q.label}: ${ans.toUpperCase()}\n`;
      });

      report += `
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PROCHAINE Ã‰TAPE:
${result.verdict === 'PMO' 
  ? 'â†’ ComplÃ©ter une Charte de projet et soumettre au PMO'
  : 'â†’ Utiliser le gabarit DMAIC et suivre via le rythme DMS'}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`;

      return report;
    }

    function copyReport() {
      const report = generateReport();
      navigator.clipboard.writeText(report).then(() => {
        alert('âœ“ Rapport copiÃ© dans le presse-papier!');
      }).catch(() => {
        prompt('Copiez ce rapport:', report);
      });
    }

    function downloadReport() {
      const report = generateReport();
      const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      const safeName = initiative.substring(0, 30).replace(/[^a-zA-Z0-9Ã Ã¢Ã¤Ã©Ã¨ÃªÃ«Ã¯Ã®Ã´Ã¹Ã»Ã¼Ã§\s]/gi, '').replace(/\s+/g, '_');
      a.download = `Evaluation_PMO_${safeName}_${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function resetTool() {
      step = 0;
      initiative = '';
      answers = {};
      result = null;
      
      document.getElementById('chatContainer').innerHTML = `
        <div id="welcomeMessage" class="text-center text-gray-400 py-16">
          <div class="text-6xl mb-4">ðŸ’¬</div>
          <p class="text-lg">DÃ©crivez votre initiative pour commencer</p>
          <p class="text-sm mt-2">L'outil vous guidera Ã  travers les critÃ¨res de dÃ©cision</p>
        </div>
      `;
      
      document.getElementById('initiativeInput').value = '';
      document.getElementById('initialInput').classList.remove('hidden');
      document.getElementById('questionArea').classList.add('hidden');
      document.getElementById('resultArea').classList.add('hidden');
      document.getElementById('progressBar').classList.add('hidden');
    }
  </script>
</body>
</html>
